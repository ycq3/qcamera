# 定时拍照助手

一个Android应用程序，具备自动拍照、照片处理、参数设置、拍摄控制和存储管理功能。

## 功能特性

1. **自动拍照功能**
   - 按照用户设定的时间间隔自动拍摄照片
   - 支持在设备锁屏状态下后台运行拍照功能

2. **照片处理选项**
   - 将拍摄的照片保存到设备存储中
   - 或将照片通过电子邮件发送到指定邮箱地址

3. **拍摄参数设置**
   - 允许用户配置相机参数（如分辨率、质量等）
   - 可设置拍摄间隔时间

4. **拍摄控制选项**
   - 支持设置自动停止条件：按时间停止（指定结束时间）或按数量停止（拍摄指定张数后停止）

5. **存储管理功能**
   - 当设备存储空间不足时，自动删除较旧的照片以释放空间

## 技术实现

### 核心组件

- **CameraManager**: 负责相机操作和拍照功能
- **CameraService**: 后台服务，管理定时拍照任务
- **CameraWorker**: 使用WorkManager执行周期性拍照任务
- **SettingsManager**: 管理应用设置
- **StorageManager**: 管理照片存储和空间清理
- **EmailManager**: 处理邮件发送功能

### 权限要求

- `CAMERA`: 访问相机硬件
- `WRITE_EXTERNAL_STORAGE`: 保存照片到存储
- `FOREGROUND_SERVICE`: 运行前台服务
- `WAKE_LOCK`: 在锁屏状态下保持运行

### 架构设计

应用采用前后台分离的设计模式：
- 前台：MainActivity提供用户界面交互
- 后台：CameraService作为前台服务运行，确保在锁屏状态下也能持续工作
- 工作管理：使用WorkManager调度周期性拍照任务

## 构建和运行

### 环境要求

- Android Studio 4.0 或更高版本
- Android SDK API 24 (Android 7.0) 或更高版本
- 支持相机功能的Android设备

### 构建步骤

1. 克隆或下载项目代码
2. 在Android Studio中打开项目
3. 同步Gradle依赖
4. 构建并运行应用

### 使用说明

1. **初始设置**
   - 打开应用后点击"设置"按钮配置拍照参数
   - 设置拍摄间隔、照片分辨率和质量
   - 配置停止条件（按时间或数量）
   - 设置存储管理选项
   - 配置邮件发送功能（可选）

2. **开始拍照**
   - 返回主界面，点击"开始拍照"按钮
   - 应用将在后台开始定时拍照
   - 状态栏会显示通知，表明服务正在运行

3. **停止拍照**
   - 点击"停止拍照"按钮停止服务
   - 拍摄的照片保存在应用的私有存储目录中

## 注意事项

1. 应用需要相机和存储权限才能正常工作
2. 在锁屏状态下运行需要设备的电池优化设置中将应用设为不优化
3. 邮件发送功能需要网络连接
4. 存储空间管理功能会自动删除旧照片以释放空间，请谨慎使用

## 代码结构

```
app/
├── src/main/java/com/camera/app/
│   ├── MainActivity.java           # 主活动
│   ├── SettingsActivity.java       # 设置活动
│   ├── CameraService.java          # 拍照服务
│   ├── CameraWorker.java           # 拍照工作器
│   ├── CameraManager.java          # 相机管理器
│   ├── SettingsManager.java        # 设置管理器
│   ├── StorageManager.java         # 存储管理器
│   ├── EmailManager.java           # 邮件管理器
│   └── BootReceiver.java           # 开机广播接收器
├── src/main/res/
│   ├── layout/                     # 布局文件
│   ├── values/                     # 资源文件
│   ├── drawable/                   # 图片资源
│   └── xml/                        # 配置文件
└── build.gradle                   # 构建配置
```

## 可能的改进方向

1. 添加更多相机参数设置（如白平衡、曝光等）
2. 实现更复杂的照片处理功能（如滤镜、水印等）
3. 改进邮件发送功能，支持SMTP认证
4. 添加照片预览和管理功能
5. 实现云端存储选项
6. 添加更多停止条件（如存储空间、电池电量等）